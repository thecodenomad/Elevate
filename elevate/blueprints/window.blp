using Gtk 4.0;
using Adw 1;

template $ElevateWindow: Adw.Window {
  title: _("Elevate");

  /* TODO: Rework for mobile */
  width-request: 675;
  height-request: 500;
  default-width: 675;
  default-height: 480;

  Adw.Breakpoint {
    condition ("max-width: 400sp")

    setters {
      split_view.collapsed: true;
    }
  }

  content: Adw.ToolbarView {
    top-bar-style: raised;

    [top]
    Adw.HeaderBar header_bar {
      [start]
      ToggleButton sidebar_toggle_button {
        icon-name: "sidebar-show-symbolic";
        tooltip-text: "Toggle Sidebar";
        active: true;
      }

      [end]
      Button preferences_button {
        icon-name: "emblem-system-symbolic";
        tooltip-text: "Open Settings";
      }
    }

    content: Adw.OverlaySplitView split_view {
      show-sidebar: true;

      sidebar: ScrolledWindow scrolled_window {
        hexpand: true;
        width-request: 400;
      };

      content: Box content_area {
        orientation: vertical;
        hexpand: true;
        vexpand: true;

        Overlay overlay_area {
          hexpand: true;
          vexpand: true;

          DrawingArea stimuli_renderer {
            hexpand: true;
            vexpand: true;
          }

          [overlay]
          Box toolbar {
            margin-start: 24;
            margin-end: 24;
            margin-bottom: 18;
            valign: end;
            hexpand: true;

            Box {
              orientation: horizontal;
              hexpand: true;

              ToggleButton toolbar_sidebar_toggle {
                icon-name: "sidebar-show-symbolic";
                tooltip-text: _("Configuration");
                visible: false;
              }

              ToggleButton play_button {
                icon-name: "media-playback-start-symbolic";
                tooltip-text: _("Play");
                margin-end: 5;
              }

              MenuButton volume_button {
                icon-name: "audio-volume-high-symbolic";
                tooltip-text: _("Volume");
                primary: true;
                direction: up;

                popover: Popover volume_popover {
                  has-arrow: false;
                  autohide: true;

                  Box {
                    orientation: vertical;
                    margin-start: 8;
                    margin-end: 8;
                    margin-top: 8;
                    margin-bottom: 8;

                    Scale volume_scale {
                      height-request: 160;
                      orientation: vertical;
                      inverted: true;
                      show-fill-level: true;
                      draw-value: false;

                      adjustment: Adjustment {
                        lower: 0.0;
                        upper: 1.0;
                        step-increment: 0.01;
                        page-increment: 0.1;
                        value: 0.5;
                      };
                    }
                  }
                };
              }

              Scale time_scale {
                hexpand: true;
                orientation: horizontal;
                show-fill-level: true;

                adjustment: Adjustment {
                  lower: 0;
                  upper: 100;
                  value: 0;
                };
              }

              Label run_time_label {
                label: "00:00";
              }

              ToggleButton fullscreen_button {
                icon-name: "view-fullscreen-symbolic";
                tooltip-text: _("Fullscreen");
              }
            }

            styles [
              "toolbar",
              "osd",
              "darken",
            ]
          }
        }
      };
    };
  };
}
